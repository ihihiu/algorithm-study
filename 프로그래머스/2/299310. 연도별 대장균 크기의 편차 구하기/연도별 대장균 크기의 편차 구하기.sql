-- 코드를 작성해주세요
WITH MAX_DATA AS
(
    SELECT YEAR(DIFFERENTIATION_DATE) AS MAX_YEAR
        , MAX(SIZE_OF_COLONY) AS MAX_SIZE
    FROM ECOLI_DATA
    GROUP BY YEAR(DIFFERENTIATION_DATE)
)

SELECT B.MAX_YEAR AS YEAR
    , (B.MAX_SIZE - A.SIZE_OF_COLONY) AS YEAR_DEV
    , A.ID
FROM ECOLI_DATA AS A
    JOIN MAX_DATA AS B
        ON YEAR(A.DIFFERENTIATION_DATE) = B.MAX_YEAR
ORDER BY B.MAX_YEAR, YEAR_DEV;

